<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.0.0">
  <link rel="icon" type="image/png" sizes="32x32" href="https://cosmos-1251905798.cos.ap-beijing.myqcloud.com/theme/favicon.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="https://cosmos-1251905798.cos.ap-beijing.myqcloud.com/theme/favicon.ico">
  <link rel="alternate" href="/atom.xml" title="Houmin" type="application/atom+xml">
  <meta name="google-site-verification" content="zdGhdEF7jHoJW58lsdN6l9JrQFjJFwakCIc7TbbosV0">
  <meta name="msvalidate.01" content="2F527B379ED5537861D0D38C2C754C2B">
  <meta name="baidu-site-verification" content="xAag2PqzKE">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/font-awesome@4/css/font-awesome.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/pace-js@1/themes/blue/pace-theme-minimal.css">
  <script src="//cdn.jsdelivr.net/npm/pace-js@1/pace.min.js"></script>


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '7.5.0',
    exturl: false,
    sidebar: {"position":"right","display":"post","offset":12,"onmobile":true},
    copycode: {"enable":true,"show_result":true,"style":"mac"},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":true},
    bookmark: {"enable":true,"color":"#222","save":"auto"},
    fancybox: true,
    mediumzoom: false,
    lazyload: true,
    pangu: false,
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: 'search.xml',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    translation: {
      copy_button: '复制',
      copy_success: '复制成功',
      copy_failure: '复制失败'
    },
    sidebarPadding: 40
  };
</script>

  <meta name="description" content="REST 全称是 Representational State Transfer，由 Roy Fielding 2000年在其博士论文 Architectural Styles and the Design of Network-based Software Architectures 中提出，目标是在基于网络的软件设计中，得到一个功能强、性能好、适宜通信的架构。随着互联网的兴起，软件与网络两个领">
<meta name="keywords" content="REST,api,SOAP,RPC">
<meta property="og:type" content="article">
<meta property="og:title" content="RESTful API">
<meta property="og:url" content="http://houmin.cc/posts/45b76dc5/index.html">
<meta property="og:site_name" content="Houmin">
<meta property="og:description" content="REST 全称是 Representational State Transfer，由 Roy Fielding 2000年在其博士论文 Architectural Styles and the Design of Network-based Software Architectures 中提出，目标是在基于网络的软件设计中，得到一个功能强、性能好、适宜通信的架构。随着互联网的兴起，软件与网络两个领">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2020-12-04T12:35:29.547Z">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://houmin.cc/posts/45b76dc5/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: false,
    isPost: true,
    isPage: false,
    isArchive: false
  };
</script>

  <title>RESTful API | Houmin</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>


  <script src="/js/photoswipe.min.js?v="></script>
  <script src="/js/photoswipe-ui-default.min.js?v="></script>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Houmin</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
        <h1 class="site-subtitle" itemprop="description">Yesterday You Said Tomorrow</h1>
      
  </div>

  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>首页</a>

  </li>
        <li class="menu-item menu-item-album">

    <a href="/album" rel="section"><i class="fa fa-fw fa-camera"></i>相册</a>

  </li>
        <li class="menu-item menu-item-movies">

    <a href="/movies/" rel="section"><i class="fa fa-fw fa-film"></i>观影</a>

  </li>
        <li class="menu-item menu-item-books">

    <a href="/books/" rel="section"><i class="fa fa-fw fa-book"></i>阅读</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>标签</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>归档</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i>关于</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>

</nav>
  <div class="site-search">
    <div class="popup search-popup">
    <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="搜索..." spellcheck="false" type="text" id="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result"></div>

</div>
<div class="search-pop-overlay"></div>

  </div>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block " lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://houmin.cc/posts/45b76dc5/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://cosmos-1251905798.cos.ap-beijing.myqcloud.com/theme/avatar.png">
      <meta itemprop="name" content="Houmin">
      <meta itemprop="description" content="丈夫拥书万卷，何假南面百城">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Houmin">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          RESTful API
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-07-14 17:45:45" itemprop="dateCreated datePublished" datetime="2020-07-14T17:45:45+08:00">2020-07-14</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%9C%AF%E4%B8%9A%E4%B8%93%E6%94%BB/" itemprop="url" rel="index">
                    <span itemprop="name">术业专攻</span>
                  </a>
                </span>
            </span>

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/posts/45b76dc5/#comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/posts/45b76dc5/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="fa fa-file-word-o"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>13k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="fa fa-clock-o"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>23 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p><code>REST</code> 全称是 <code>Representational State Transfer</code>，由 <code>Roy Fielding</code> 2000年在其博士论文 <a href="https://www.ics.uci.edu/~fielding/pubs/dissertation/top.htm" target="_blank" rel="external nofollow noopener noreferrer">Architectural Styles and the Design of Network-based Software Architectures</a> 中提出，目标是在基于网络的软件设计中，得到一个功能强、性能好、适宜通信的架构。随着互联网的兴起，软件与网络两个领域开始融合，RESTful API 设计也得到了广泛的应用。本文将介绍 RESTful 架构的约束条件与原则，并介绍 <code>RESTful API</code> 设计的最佳实践。</p>
<a id="more"></a>
<h2 id="关键概念"><a href="#关键概念" class="headerlink" title="关键概念"></a>关键概念</h2><h3 id="Resource"><a href="#Resource" class="headerlink" title="Resource"></a>Resource</h3><p><code>REST</code> 架构中最关键的一个概念抽象是 <code>resource</code>，任何网络上的一个实体或者具体的信息都可以叫做 <code>resouce</code>：一段文本、一张图片、一个临时的服务、其他 <code>resource</code> 的集合，甚至是一个非虚拟的对象（比如一个人）。你可以用一个URI（统一资源定位符）指向它，每种资源对应一个特定的URI。要获取这个资源，访问它的URI就可以，因此URI就成了每一个资源的地址或独一无二的识别符。</p>
<h3 id="Representation"><a href="#Representation" class="headerlink" title="Representation"></a>Representation</h3><p>在任何一个特定时刻，一个 <code>resource</code> 的状态称作 <code>resource representation</code>。一个 <code>representation</code> 包含data、描述data的metadata，以及能够帮助 client 转换到下一个状态的 <code>hypermedia links</code>。一个 <code>representation</code> 的数据格式被称作一个 <strong><a href="https://www.iana.org/assignments/media-types/media-types.xhtml" target="_blank" rel="external nofollow noopener noreferrer">media type</a></strong> 。<code>Media Type</code> 定义了一个 <code>representation</code> 该如何被处理的规范。比如，文本可以用txt格式表现，也可以用HTML格式、XML格式、JSON格式表现，甚至可以采用二进制格式；图片可以用JPG格式表现，也可以用PNG格式表现。</p>
<p>URI只代表资源的实体，不代表它的形式。严格地说，有些网址最后的<code>.html</code>后缀名是不必要的，因为这个后缀名表示格式，属于”表现层”范畴，而URI应该只代表<code>resource</code>的位置。它的具体表现形式，应该在HTTP请求的头信息中用 <code>Accept</code> 和 <code>Content-Type</code> 字段指定，这两个字段才是对 <code>representation</code> 的描述。</p>
<p> <strong>A truly RESTful API looks like <em>hypertext</em></strong>。任何可以被定位的信息包含一个显示或者隐式的地址。根据 <code>Roy Fielding</code> 所言：</p>
<blockquote>
<p>Hypertext (or hypermedia) means the <strong>simultaneous presentation of information and controls</strong> such that the information becomes the affordance through which the user (or automaton) obtains choices and selects actions. Remember that hypertext does not need to be HTML (or XML or JSON) on a browser. Machines can follow links when they understand the data format and relationship types.</p>
</blockquote>
<h3 id="State-Transfer"><a href="#State-Transfer" class="headerlink" title="State Transfer"></a>State Transfer</h3><p>访问一个网站，就代表了客户端和服务器的一个互动过程。在这个过程中，势必涉及到数据和状态的变化。</p>
<p>互联网通信协议HTTP协议，是一个无状态协议。这意味着，所有的状态都保存在服务器端。因此，<strong>如果客户端想要操作服务器，必须通过某种手段，让服务器端发生”状态转化”（State Transfer）。而这种转化是建立在表现层之上的，所以就是”表现层状态转化”。</strong></p>
<p>客户端用到的手段，可以是HTTP协议。具体来说，就是HTTP协议里面，四个表示操作方式的动词：GET、POST、PUT、DELETE。它们分别对应四种基本操作：<strong>GET用来获取资源，POST用来新建资源（也可以用于更新资源），PUT用来更新资源，DELETE用来删除资源。</strong></p>
<h2 id="约束条件"><a href="#约束条件" class="headerlink" title="约束条件"></a>约束条件</h2><p>REST指的是一组架构约束条件和原则。如果一个架构符合REST的约束条件和原则，我们就称它为 RESTful架构。 <code>Roy Fielding</code> 在其论文中提出了下面六个约束条件：</p>
<h3 id="Uniform-Interface"><a href="#Uniform-Interface" class="headerlink" title="Uniform Interface"></a>Uniform Interface</h3><p>这是 RESTful 系统设计的基本出发点. 它简化了系统架构, 减少了耦合性, 可以让所有模块各自独立的进行改进. 包括下列四个限制：</p>
<ul>
<li>请求中包含资源的 ID (<strong>Resource identification in requests</strong>)<ul>
<li>请求中包含了各种独立资源的标识。例如，在 Web 服务中的 URIs</li>
<li>资源本身和发送给客户端的标识是独立。例如，服务器可以将自身的数据库信息以 <code>XML</code> 或者 <code>JSON</code> 的方式发送给客户端，但是这些可能都不是服务器的内部记录方式.</li>
</ul>
</li>
<li>资源通过标识来操作 (<strong>Resource manipulation through representations</strong>) <ul>
<li>当客户端拥有一个资源的标识，包括附带的元数据，则它就有足够的信息来删除这个资源。</li>
</ul>
</li>
<li>消息的自我描述性 (<strong>Self-descriptive messages</strong>) <ul>
<li>每一个消息都包含足够的信息来描述如何来处理这个信息。例如，媒体类型 (midia-type) 就可以确定需要什么样的分析器来分析媒体数据</li>
</ul>
</li>
<li>用超媒体驱动应用状态 (<strong>Hypermedia as the engine of application state</strong> (<strong>HATEOAS</strong>)) <ul>
<li>同用户访问 Web 服务器的 Home 页面相似，当一个 REST 客户端访问了最初的 REST 应用的 URI 之后，REST 客户端应该可以使用服务器端提供的链接，动态的发现所有的可用的资源和可执行的操作。随着访问的进行，服务器在响应中提供文字超链接，以便客户端可以得到当前可用的操作。</li>
<li>客户端无需用确定的编码的方式记录下服务器端所提供的动态应用的结构信息。 </li>
</ul>
</li>
</ul>
<blockquote>
<p>Once a developer becomes familiar with one of your APIs，he should be able to follow a similar approach for other APIs.</p>
</blockquote>
<h3 id="Client-Server"><a href="#Client-Server" class="headerlink" title="Client-Server"></a>Client-Server</h3><p><code>client-server</code> 结构限制的目的是将 <code>client</code> 和 <code>server</code> 的关注点分离。 将 <strong>用户界面所关注的逻辑</strong> 和 <strong>数据存储所关注的逻辑</strong> 分离开来有助于提高用户界面的跨平台的可移植性，通过简化服务器模块也有助于服务器模块的可扩展性。</p>
<blockquote>
<p>Servers and clients may also be replaced and developed independently, as long as the interface between them is not altered.</p>
</blockquote>
<h3 id="Stateless"><a href="#Stateless" class="headerlink" title="Stateless"></a>Stateless</h3><p>服务器不能保存客户端的信息，每一次从客户端发送的请求中，要包含所有的必须的状态信息，会话信息由客户端保存， 服务器端根据这些状态信息来处理请求。 服务器可以将会话状态信息传递给其他服务， 比如数据库服务，这样可以保持一段时间的状态信息，从而实现认证功能。 </p>
<p>当客户端可以切换到一个新状态的时候发送请求信息。当一个或者多个请求被发送之后，客户端就处于一个状态变迁过程中，每一个应用的状态描述可以被客户端用来初始化下一次的状态变迁。</p>
<blockquote>
<p><strong>No client context shall be stored on the server between requests</strong>. The client is responsible for managing the state of the application.</p>
</blockquote>
<h3 id="Cacheable"><a href="#Cacheable" class="headerlink" title="Cacheable"></a>Cacheable</h3><p>如同万维网一样，客户端和中间的通讯传递者可以将回复缓存起来。 回复必须明确的或者间接的表明本身是否可以进行缓存， 这可以预防客户端在将来进行请求的时候得到陈旧的或者不恰当的数据。管理良好的缓存机制可以减少客户端-服务器之间的交互， 甚至完全避免客户端-服务器交互，这进一步提了高性能和可扩展性。</p>
<blockquote>
<p><strong>Well-managed caching partially or completely eliminates some client-server interactions</strong>, further improving scalability and performance.</p>
</blockquote>
<h3 id="Layered-System"><a href="#Layered-System" class="headerlink" title="Layered System"></a>Layered System</h3><p>客户端一般不知道是否直接连接到了最终的服务器，或者是路径上的中间服务器。中间服务器可以通过负载均衡和共享缓存的机制提高系统的可扩展性,这样可也便于安全策略的部署。</p>
<h3 id="Code-On-Demand-Optional"><a href="#Code-On-Demand-Optional" class="headerlink" title="Code On Demand (Optional)"></a>Code On Demand (Optional)</h3><p>服务器可以通过发送可执行代码给客户端的方式临时性的扩展功能或者定制功能。例如Java Applet、Flash或JavaScript。</p>
<blockquote>
<p>All the above constraints help you build a truly RESTful API，and you should follow them. Still，at times，you may find yourself violating one or two constraints. Do not worry; you are still making a RESTful API – but not <code>truly RESTful.</code></p>
</blockquote>
<h2 id="最佳实践"><a href="#最佳实践" class="headerlink" title="最佳实践"></a>最佳实践</h2><h3 id="Resource-Naming"><a href="#Resource-Naming" class="headerlink" title="Resource Naming"></a>Resource Naming</h3><p>在 <code>REST</code> 设计中，<code>resource</code> 是最基本的数据表示层，拥有一个一致的资源命名策略是设计中的一个关键问题。</p>
<ul>
<li><strong>A resource can be a singleton or a collection</strong></li>
</ul>
<p>举例来说，<code>customers</code> 是一种 <code>collection resource</code>，而 <code>customer</code> 是一种 <code>singleton resource</code>。那么我们访问 <code>customers</code>资源可以使用 <code>/customers</code> 这种 URI，访问 <code>customer</code> 资源可以使用 <code>/customers/{customerId}</code> 这种URI。</p>
<ul>
<li><strong>A resource may contain sub-collection resources</strong></li>
</ul>
<p>还是上面的例子，<code>customer</code> 资源可能有 <code>sub-collection</code> 资源，那么我们可以通过 <code>/customers/{customerId}/accounts</code> 这种 URI 访问。进一步的，针对 <code>accounts</code> 的单一资源，可以使用 <code>/customers/{customerId}/accounts/{accountId}</code> 这种URI来访问。</p>
<h4 id="使用名词表示资源"><a href="#使用名词表示资源" class="headerlink" title="使用名词表示资源"></a>使用名词表示资源</h4><p>RESTful URI 使用 名词 来表示资源，而不是动词。一般来说名词有四种类型：</p>
<ul>
<li>document</li>
</ul>
<p><code>document</code> 类型的资源类似于一个 <code>object instance</code> 或者是 <code>database record</code>，REST 中可以把它视作是 <code>single resource</code>，URI中一般使用单数形式。</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://api.example.com/device-management/managed-devices/&#123;device-id&#125;</span></span><br><span class="line"><span class="attribute">http://api.example.com/user-management/users/&#123;id&#125;</span></span><br><span class="line"><span class="attribute">http://api.example.com/user-management/users/admin</span></span><br></pre></td></tr></table></figure>
<ul>
<li>collection</li>
</ul>
<p><code>collection</code> 类型的资源是 <code>server-managed directory of resources</code>，一般用复数形式表示。</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://api.example.com/device-management/managed-devices</span></span><br><span class="line"><span class="attribute">http://api.example.com/user-management/users</span></span><br><span class="line"><span class="attribute">http://api.example.com/user-management/users/&#123;id&#125;/accounts</span></span><br></pre></td></tr></table></figure>
<ul>
<li>store</li>
</ul>
<p><code>store</code> 类型的资源是 <code>client-managed resource repository</code>，与 <code>collection</code> 不同，这个是 <code>client</code> 维护的，<code>client</code> 可以修改这部分的内容，或者删除它们，一般用复数形式表示。</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://api.example.com/song-management/users/&#123;id&#125;/playlists</span></span><br></pre></td></tr></table></figure>
<ul>
<li>controller</li>
</ul>
<p><code>controller</code> 类型的资源代表一个过程，一般是执行的函数，使用 <code>verb</code> 表示这种类型。</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://api.example.com/cart-management/users/&#123;id&#125;/cart/checkout</span></span><br><span class="line"><span class="attribute">http://api.example.com/song-management/users/&#123;id&#125;/playlist/play</span></span><br></pre></td></tr></table></figure>
<h4 id="不要使用-CURD-动词"><a href="#不要使用-CURD-动词" class="headerlink" title="不要使用 CURD 动词"></a>不要使用 CURD 动词</h4><p>不用在 URI 中使用 <code>CURD</code> 动词，而要通过 <code>HTTP Request Method</code> 方法。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">GET http://api.example.com/device-management/managed-devices  //Get all devices</span><br><span class="line">POST http://api.example.com/device-management/managed-devices  //Create new Device</span><br><span class="line">GET http://api.example.com/device-management/managed-devices/&#123;id&#125;  //Get device for given Id</span><br><span class="line">PUT http://api.example.com/device-management/managed-devices/&#123;id&#125;  //Update device for given Id</span><br><span class="line">DELETE http://api.example.com/device-management/managed-devices/&#123;id&#125;  //Delete device for given Id</span><br></pre></td></tr></table></figure>
<h4 id="采用查询字符串来过滤"><a href="#采用查询字符串来过滤" class="headerlink" title="采用查询字符串来过滤"></a>采用查询字符串来过滤</h4><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://api.example.com/device-management/managed-devices</span></span><br><span class="line">http://api.example.com/device-management/managed-devices?region=USA</span><br><span class="line">http://api.example.com/device-management/managed-devices?region=USA&amp;brand=XYZ</span><br><span class="line">http://api.example.com/device-management/managed-devices?region=USA&amp;brand=XYZ&amp;sort=installation-date</span><br></pre></td></tr></table></figure>
<h4 id="URI可读性与持续性"><a href="#URI可读性与持续性" class="headerlink" title="URI可读性与持续性"></a>URI可读性与持续性</h4><p><strong>Use forward slash (/) to indicate hierarchical relationships</strong></p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://api.example.com/device-management</span></span><br><span class="line"><span class="attribute">http://api.example.com/device-management/managed-devices</span></span><br><span class="line"><span class="attribute">http://api.example.com/device-management/managed-devices/&#123;id&#125;</span></span><br><span class="line"><span class="attribute">http://api.example.com/device-management/managed-devices/&#123;id&#125;/scripts</span></span><br><span class="line"><span class="attribute">http://api.example.com/device-management/managed-devices/&#123;id&#125;/scripts/&#123;id&#125;</span></span><br></pre></td></tr></table></figure>
<p><strong>Do not use trailing forward slash (/) in URIs</strong></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="comment">//api.example.com/device-management/managed-devices/</span></span><br><span class="line">http:<span class="comment">//api.example.com/device-management/managed-devices 	/*This is much better version*/</span></span><br></pre></td></tr></table></figure>
<p><strong>Use hyphens (-) to improve the readability of URIs</strong></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="comment">//api.example.com/inventory-management/managed-entities/&#123;id&#125;/install-script-location  //More readable</span></span><br><span class="line">http:<span class="comment">//api.example.com/inventory-management/managedEntities/&#123;id&#125;/installScriptLocation  //Less readable</span></span><br></pre></td></tr></table></figure>
<p><strong>Do not use underscores ( _ )</strong></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="comment">//api.example.com/inventory-management/managed-entities/&#123;id&#125;/install-script-location  //More readable</span></span><br><span class="line">http:<span class="comment">//api.example.com/inventory_management/managed_entities/&#123;id&#125;/install_script_location  //More error prone</span></span><br></pre></td></tr></table></figure>
<p><strong>Use lowercase letters in URIs</strong></p>
<p><a href="https://www.ietf.org/rfc/rfc3986.txt" target="_blank" rel="external nofollow noopener noreferrer">RFC 3986</a> 定义了 URI <code>case-sensitive</code>  但是 scheme 和 host 不敏感，所以下面1和2是相同的，但是3和另外两个并不相同，推荐尽量使用小写字符。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="comment">//api.example.org/my-folder/my-doc  //1</span></span><br><span class="line">HTTP:<span class="comment">//API.EXAMPLE.ORG/my-folder/my-doc  //2</span></span><br><span class="line">http:<span class="comment">//api.example.org/My-Folder/my-doc  //3</span></span><br></pre></td></tr></table></figure>
<p><strong>Do not use file extentions</strong></p>
<p>不要在 URI 中加上文件后缀，相反通过 <code>Content-Type</code> 获取 <code>media-type</code>。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="comment">//api.example.com/device-management/managed-devices.xml  /*Do not use it*/</span></span><br><span class="line">http:<span class="comment">//api.example.com/device-management/managed-devices 	/*This is correct URI*/</span></span><br></pre></td></tr></table></figure>
<h3 id="Status-Code"><a href="#Status-Code" class="headerlink" title="Status Code"></a>Status Code</h3><h4 id="状态码必须精确"><a href="#状态码必须精确" class="headerlink" title="状态码必须精确"></a>状态码必须精确</h4><p>客户端的每一次请求，服务器都必须给出回应。回应包括 HTTP 状态码和数据两部分。</p>
<p>HTTP 状态码就是一个三位数，分成五个类别。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">`1xx`：相关信息</span><br><span class="line">`2xx`：操作成功</span><br><span class="line">`3xx`：重定向</span><br><span class="line">`4xx`：客户端错误</span><br><span class="line">`5xx`：服务器错误</span><br></pre></td></tr></table></figure>
<p>这五大类总共包含<a href="https://en.wikipedia.org/wiki/List_of_HTTP_status_codes" target="_blank" rel="external nofollow noopener noreferrer">100多种</a>状态码，覆盖了绝大部分可能遇到的情况。每一种状态码都有标准的（或者约定的）解释，客户端只需查看状态码，就可以判断出发生了什么情况，所以服务器应该返回尽可能精确的状态码。</p>
<p>API 不需要<code>1xx</code>状态码，下面介绍其他四类状态码的精确含义。</p>
<h4 id="2xx-状态码"><a href="#2xx-状态码" class="headerlink" title="2xx 状态码"></a>2xx 状态码</h4><p><code>200</code>状态码表示操作成功，但是不同的方法可以返回更精确的状态码。</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">GET:</span> <span class="number">200</span> <span class="string">OK</span></span><br><span class="line"><span class="attr">POST:</span> <span class="number">201</span> <span class="string">Created</span></span><br><span class="line"><span class="attr">PUT:</span> <span class="number">200</span> <span class="string">OK</span></span><br><span class="line"><span class="attr">PATCH:</span> <span class="number">200</span> <span class="string">OK</span></span><br><span class="line"><span class="attr">DELETE:</span> <span class="number">204</span> <span class="literal">No</span> <span class="string">Content</span></span><br></pre></td></tr></table></figure>
<p>上面代码中，<code>POST</code>返回<code>201</code>状态码，表示生成了新的资源；<code>DELETE</code>返回<code>204</code>状态码，表示资源已经不存在。</p>
<p>此外，<code>202 Accepted</code>状态码表示服务器已经收到请求，但还未进行处理，会在未来再处理，通常用于异步操作。下面是一个例子。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.1 <span class="number">202</span> Accepted</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  "task": &#123;</span><br><span class="line">    "href": "/api/company/job-management/jobs/2130040"，</span><br><span class="line">    "id": "2130040"</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="3xx-状态码"><a href="#3xx-状态码" class="headerlink" title="3xx 状态码"></a>3xx 状态码</h4><p>API 用不到<code>301</code>状态码（永久重定向）和<code>302</code>状态码（暂时重定向，<code>307</code>也是这个含义），因为它们可以由应用级别返回，浏览器会直接跳转，API 级别可以不考虑这两种情况。</p>
<p>API 用到的<code>3xx</code>状态码，主要是<code>303 See Other</code>，表示参考另一个 URL。它与<code>302</code>和<code>307</code>的含义一样，也是”暂时重定向”，区别在于<code>302</code>和<code>307</code>用于<code>GET</code>请求，而<code>303</code>用于<code>POST</code>、<code>PUT</code>和<code>DELETE</code>请求。收到<code>303</code>以后，浏览器不会自动跳转，而会让用户自己决定下一步怎么办。下面是一个例子。</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.1 <span class="number">303</span> See Other</span><br><span class="line"><span class="attribute">Location</span>: /api/orders/12345</span><br></pre></td></tr></table></figure>
<h4 id="4xx-状态码"><a href="#4xx-状态码" class="headerlink" title="4xx 状态码"></a>4xx 状态码</h4><p><code>4xx</code>状态码表示客户端错误，主要有下面几种：</p>
<ul>
<li><code>400 Bad Request</code>：服务器不理解客户端的请求，未做任何处理。</li>
<li><code>401 Unauthorized</code>：用户未提供身份验证凭据，或者没有通过身份验证。</li>
<li><code>403 Forbidden</code>：用户通过了身份验证，但是不具有访问资源所需的权限。</li>
<li><code>404 Not Found</code>：所请求的资源不存在，或不可用。</li>
<li><code>405 Method Not Allowed</code>：用户已经通过身份验证，但是所用的 HTTP 方法不在他的权限之内。</li>
<li><code>410 Gone</code>：所请求的资源已从这个地址转移，不再可用。</li>
<li><code>415 Unsupported Media Type</code>：客户端要求的返回格式不支持。比如，API 只能返回 JSON 格式，但是客户端要求返回 XML 格式。</li>
<li><code>422 Unprocessable Entity</code> ：客户端上传的附件无法处理，导致请求失败。</li>
<li><code>429 Too Many Requests</code>：客户端的请求次数超过限额。</li>
</ul>
<h4 id="5xx-状态码"><a href="#5xx-状态码" class="headerlink" title="5xx 状态码"></a>5xx 状态码</h4><p><code>5xx</code>状态码表示服务端错误。一般来说，API 不会向用户透露服务器的详细信息，所以只要两个状态码就够了。</p>
<ul>
<li><code>500 Internal Server Error</code>：客户端请求有效，服务器处理时发生了意外。</li>
<li><code>503 Service Unavailable</code>：服务器无法处理请求，一般用于网站维护状态。</li>
</ul>
<h3 id="Caching"><a href="#Caching" class="headerlink" title="Caching"></a>Caching</h3><p><code>Cacheable</code> 是 <code>REST</code> 架构中的一个约束条件，<code>GET</code> 请求默认是都是 <code>Cacheable</code> 的，<code>POST</code>请求默认不是<code>Cacheable</code>的，可以通过设置 <code>Expires</code> 或者 <code>Cache-Control</code>来显示设置，<code>PUT</code> 和 <code>DELETE</code> 请求的响应是完全不可Cache的。</p>
<h4 id="Expires"><a href="#Expires" class="headerlink" title="Expires"></a>Expires</h4><p><code>Expires</code> 响应头包含日期/时间， 即在此时候之后，响应过期。无效的日期，比如 0, 代表着过去的日期，即该资源已经过期。</p>
<p>如果在<a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Cache-Control" target="_blank" rel="external nofollow noopener noreferrer"><code>Cache-Control</code></a>响应头设置了 “max-age” 或者 “s-max-age” 指令，那么 <code>Expires</code> 头会被忽略。</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Expires</span>: Fri, 20 May 2016 19:20:49 IST</span><br></pre></td></tr></table></figure>
<h4 id="Cache-Control"><a href="#Cache-Control" class="headerlink" title="Cache-Control"></a>Cache-Control</h4><p><code>Cache-Control</code> 通用消息头字段，被用于在http请求和响应中，通过指定指令来实现缓存机制。缓存指令是单向的，这意味着在请求中设置的指令，不一定被包含在响应中。</p>
<ul>
<li><strong>缓存请求指令</strong></li>
</ul>
<p>客户端可以在HTTP请求中使用的标准 Cache-Control 指令。</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Cache-Control</span>: max-age=&lt;seconds&gt;</span><br><span class="line"><span class="attribute">Cache-Control</span>: max-stale[=&lt;seconds&gt;]</span><br><span class="line"><span class="attribute">Cache-Control</span>: min-fresh=&lt;seconds&gt;</span><br><span class="line"><span class="attribute">Cache-control</span>: no-cache </span><br><span class="line"><span class="attribute">Cache-control</span>: no-store</span><br><span class="line"><span class="attribute">Cache-control</span>: no-transform</span><br><span class="line"><span class="attribute">Cache-control</span>: only-if-cached</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>缓存响应指令</strong></li>
</ul>
<p>服务器可以在响应中使用的标准 Cache-Control 指令。</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Cache-control</span>: must-revalidate</span><br><span class="line"><span class="attribute">Cache-control</span>: no-cache</span><br><span class="line"><span class="attribute">Cache-control</span>: no-store</span><br><span class="line"><span class="attribute">Cache-control</span>: no-transform</span><br><span class="line"><span class="attribute">Cache-control</span>: public</span><br><span class="line"><span class="attribute">Cache-control</span>: private</span><br><span class="line"><span class="attribute">Cache-control</span>: proxy-revalidate</span><br><span class="line"><span class="attribute">Cache-Control</span>: max-age=&lt;seconds&gt;</span><br><span class="line"><span class="attribute">Cache-control</span>: s-maxage=&lt;seconds&gt;</span><br></pre></td></tr></table></figure>
<h4 id="ETag"><a href="#ETag" class="headerlink" title="ETag"></a>ETag</h4><p><strong><code>ETag</code></strong> HTTP响应头是资源的特定版本的标识符。这可以让缓存更高效，并节省带宽，因为如果内容没有改变，Web服务器不需要发送完整的响应。而如果内容发生了变化，使用ETag有助于防止资源的同时更新相互覆盖（“空中碰撞”）。</p>
<p>如果给定URL中的资源更改，则一定要生成新的Etag值。 因此Etags类似于指纹，也可能被某些服务器用于跟踪。 比较etags能快速确定此资源是否变化，但也可能被跟踪服务器永久存留。</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">ETag</span>: "abcd1234567n34jv"</span><br></pre></td></tr></table></figure>
<h4 id="Last-Modified"><a href="#Last-Modified" class="headerlink" title="Last-Modified"></a>Last-Modified</h4><p>The <strong><code>Last-Modified</code></strong> 是一个响应首部，其中包含源头服务器认定的资源做出修改的日期及时间。 它通常被用作一个验证器来判断接收到的或者存储的资源是否彼此一致。由于精确度比  <a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/ETag" target="_blank" rel="external nofollow noopener noreferrer"><code>ETag</code></a> 要低，所以这是一个备用机制。</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Last-Modified</span>: Fri, 10 May 2016 09:17:49 IST</span><br></pre></td></tr></table></figure>
<h3 id="Content-Negotiation"><a href="#Content-Negotiation" class="headerlink" title="Content Negotiation"></a>Content Negotiation</h3><p>一般来说，资源都有多种表现形式，client 选择一个合适的表现形式称作 <code>content negotiation</code>。</p>
<p><code>client</code> 可以在 <code>request</code> 中通过 <code>Content-Type</code>字段指定 <code>client</code> 发送资源的表现形式，常见的有 <code>text/plain</code>, <code>application/xml</code>, <code>text/html</code>, <code>application/json</code>, <code>image/gif</code>, and <code>image/jpeg</code>。</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Content-Type</span>: application/json</span><br></pre></td></tr></table></figure>
<p><code>client</code> 也可以通过 <code>Accept</code> 指定希望接收的数据类型，这里的 <code>q</code> 表示对不同类型的偏好设置。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">application/json,application/xml;q=0.9,*/*;q=0.8</span><br></pre></td></tr></table></figure>
<h3 id="HATEOAS"><a href="#HATEOAS" class="headerlink" title="HATEOAS"></a>HATEOAS</h3><p>API 的使用者未必知道，URL 是怎么设计的。一个解决方法就是，在回应中，给出相关链接，便于下一步操作。这样的话，用户只要记住一个 URL，就可以发现其他的 URL。这种方法叫做 <code>HATEOAS</code>，也就是 <a href="https://en.wikipedia.org/wiki/HATEOAS" target="_blank" rel="external nofollow noopener noreferrer"><strong>Hypermedia as the Engine of Application State</strong></a>。</p>
<p>举个例子，一个用户通过 <code>GET</code> 请求查询银行中某个账户的情况：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/accounts/12345</span> HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span>: bank.example.com</span><br><span class="line"><span class="attribute">Accept</span>: application/vnd.acme.account+json</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>请求的响应如下，不仅包括账户的余额信息，还包括了进一步操作的链接，用户可以取钱、存钱、转账或者关闭帐户。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.1 <span class="number">200</span> OK</span><br><span class="line"><span class="attribute">Content-Type</span>: application/vnd.acme.account+json</span><br><span class="line"><span class="attribute">Content-Length</span>: ...</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    "account": &#123;</span><br><span class="line">        "account_number": 12345,</span><br><span class="line">        "balance": &#123;</span><br><span class="line">            "currency": "usd",</span><br><span class="line">            "value": 100.00</span><br><span class="line">        &#125;,</span><br><span class="line">        "links": &#123;</span><br><span class="line">            "deposit": "/accounts/12345/deposit",</span><br><span class="line">            "withdraw": "/accounts/12345/withdraw",</span><br><span class="line">            "transfer": "/accounts/12345/transfer",</span><br><span class="line">            "close": "/accounts/12345/close"</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>当用户透支后，这时候查询账户信息，只剩下一个存钱的链接，这就是 <code>Engine of Applicaiton State</code> 名称的来源。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.1 <span class="number">200</span> OK</span><br><span class="line"><span class="attribute">Content-Type</span>: application/vnd.acme.account+json</span><br><span class="line"><span class="attribute">Content-Length</span>: ...</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    "account": &#123;</span><br><span class="line">        "account_number": 12345,</span><br><span class="line">        "balance": &#123;</span><br><span class="line">            "currency": "usd",</span><br><span class="line">            "value": -25.00</span><br><span class="line">        &#125;,</span><br><span class="line">        "links": &#123;</span><br><span class="line">            "deposit": "/accounts/12345/deposit"</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Idempotence"><a href="#Idempotence" class="headerlink" title="Idempotence"></a>Idempotence</h3><p>RESTFul API中的<strong>幂等性</strong>是指调用某个方法1次或N次对资源产生的影响结果都是相同的，需要特别注意的是：这里幂等性指的是对资源产生的影响结果，而不是调用HTTP方法的返回结果。举个例子，RESTFul API中的GET方法是查询资源信息，不会对资源产生影响，所以它是符合幂等性的，但是每次调用GET方法返回的结果有可能不同（可能资源的某个属性在调用GET方法之前已经被其他方法修改了）</p>
<blockquote>
<p><em>An idempotent HTTP method is an HTTP method that can be called many times without different outcomes. It would not matter if the method is called only once, or ten times over. The result should be the same.</em></p>
<p>Idempotence essentially means that the result of a successfully performed request is independent of the number of times it is executed. For example, in arithmetic, adding zero to a number is an idempotent operation.</p>
</blockquote>
<p> 除了幂等性之外，HTTP方法的安全性是指<strong>不对资源产生修改</strong>。 </p>
<p>常用HTTP方法的幂等性和安全性总结如下：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:left">HTTP方法名称</th>
<th style="text-align:left">是否幂等</th>
<th style="text-align:left">是否安全</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">OPTIONS</td>
<td style="text-align:left">Y</td>
<td style="text-align:left">Y</td>
</tr>
<tr>
<td style="text-align:left">HEAD</td>
<td style="text-align:left">Y</td>
<td style="text-align:left">Y</td>
</tr>
<tr>
<td style="text-align:left">GET</td>
<td style="text-align:left">Y</td>
<td style="text-align:left">Y</td>
</tr>
<tr>
<td style="text-align:left">PUT</td>
<td style="text-align:left">Y</td>
<td style="text-align:left">N</td>
</tr>
<tr>
<td style="text-align:left">DELETE</td>
<td style="text-align:left">Y</td>
<td style="text-align:left">N</td>
</tr>
<tr>
<td style="text-align:left">POST</td>
<td style="text-align:left">N</td>
<td style="text-align:left">N</td>
</tr>
<tr>
<td style="text-align:left">PATCH</td>
<td style="text-align:left">N</td>
<td style="text-align:left">N</td>
</tr>
</tbody>
</table>
</div>
<h3 id="Versioning"><a href="#Versioning" class="headerlink" title="Versioning"></a>Versioning</h3><p>随着系统的演进，API可能会发生 <code>breaking change</code>，这个时候需要对API版本化，通常有以下几种做法：</p>
<h4 id="URI-Versioning"><a href="#URI-Versioning" class="headerlink" title="URI Versioning"></a>URI Versioning</h4><p>在 URI 中添加版本是最直接的方式，虽然这违背了 URL 应该只想一个唯一的资源 的原则，kubernetes 就是采用的这种方式。</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">https://api.example.com/v1/</span></span><br><span class="line"><span class="attribute">https://api.example.com/v2beta1/</span></span><br></pre></td></tr></table></figure>
<h4 id="Versioning-using-Accept-header"><a href="#Versioning-using-Accept-header" class="headerlink" title="Versioning using Accept header"></a>Versioning using Accept header</h4><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Accept</span>: application/vnd.example.v1+json</span><br><span class="line"><span class="attribute">Accept</span>: application/vnd.example+json;version=1.0</span><br></pre></td></tr></table></figure>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><ul>
<li>资源是由URI来指定。</li>
<li>对资源的操作包括获取、创建、修改和删除，这些操作正好对应HTTP协议提供的GET、POST、PUT和DELETE方法。</li>
<li>通过操作资源的表现形式来操作资源。</li>
<li>资源的表现形式则是XML或者HTML，取决于读者是机器还是人、是消费Web服务的客户软件还是Web浏览器。当然也可以是任何其他的格式，例如JSON。</li>
</ul>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ul>
<li><a href="http://www.ics.uci.edu/~fielding/pubs/dissertation/top.htm" target="_blank" rel="external nofollow noopener noreferrer">Roy Fielding 博士论文英文版</a></li>
<li><a href="http://www.infoq.com/cn/minibooks/dissertation-rest-cn" target="_blank" rel="external nofollow noopener noreferrer">Roy Fielding 博士论文中文版</a></li>
<li><a href="https://roy.gbiv.com/untangled/2008/rest-apis-must-be-hypertext-driven" target="_blank" rel="external nofollow noopener noreferrer">REST APIs must be hypertext-driven</a></li>
<li><a href="https://restfulapi.net/" target="_blank" rel="external nofollow noopener noreferrer">REST API Tutorial</a></li>
<li><a href="https://en.wikipedia.org/wiki/Representational_state_transfer" target="_blank" rel="external nofollow noopener noreferrer">Wikipedia: REST</a></li>
<li><a href="https://nordicapis.com/rest-vs-streaming-apis-how-they-differ/" target="_blank" rel="external nofollow noopener noreferrer">REST VS Streaming API</a></li>
</ul>

    </div>

    
    
    
      
  <div class="popular-posts-header">相关文章推荐</div>
  <ul class="popular-posts">
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="/posts/b0614056/" rel="bookmark">【Kubernetes】API Install</a></div>
    </li>
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="/posts/e3978252/" rel="bookmark">【Awesome Go】Go RESTful</a></div>
    </li>
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="/posts/3bc1a603/" rel="bookmark">【Kubernetes】ApiServer 启动分析</a></div>
    </li>
  </ul>

      
        <div class="reward-container">
  <div></div>
  <button disable="enable" onclick="var qr = document.getElementById(&quot;qr&quot;); qr.style.display = (qr.style.display === 'none') ? 'block' : 'none';">
    打赏
  </button>
  <div id="qr" style="display: none;">
      
      <div style="display: inline-block;">
        <img src="https://cosmos-1251905798.cos.ap-beijing.myqcloud.com/theme/wechatpay.png" alt="Houmin 微信支付">
        <p>微信支付</p>
      </div>
      
      <div style="display: inline-block;">
        <img src="https://cosmos-1251905798.cos.ap-beijing.myqcloud.com/theme/alipay.jpg" alt="Houmin 支付宝">
        <p>支付宝</p>
      </div>

  </div>
</div>

        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>Houmin
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="http://houmin.cc/posts/45b76dc5/" title="RESTful API">http://houmin.cc/posts/45b76dc5/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/null" rel="external nofollow noopener noreferrer" target="_blank"><i class="fa fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>


      <footer class="post-footer">
          
          <div class="post-tags">
              <a href="/tags/REST/" rel="tag"><i class="fa fa-tag"></i> REST</a>
              <a href="/tags/api/" rel="tag"><i class="fa fa-tag"></i> api</a>
              <a href="/tags/SOAP/" rel="tag"><i class="fa fa-tag"></i> SOAP</a>
              <a href="/tags/RPC/" rel="tag"><i class="fa fa-tag"></i> RPC</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-next post-nav-item">
                <a href="/posts/8f35743d/" rel="next" title="【下厨房】酸甜麻辣咸">
                  <i class="fa fa-chevron-left"></i> 【下厨房】酸甜麻辣咸
                </a>
            </div>

            <span class="post-nav-divider"></span>

            <div class="post-nav-prev post-nav-item">
                <a href="/posts/e3978252/" rel="prev" title="【Awesome Go】Go RESTful">
                  【Awesome Go】Go RESTful <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
      </footer>
    
  </article>
  
  
  

  </div>


          </div>
          
    <div class="comments" id="comments"></div>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#关键概念"><span class="nav-number">1.</span> <span class="nav-text">关键概念</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Resource"><span class="nav-number">1.1.</span> <span class="nav-text">Resource</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Representation"><span class="nav-number">1.2.</span> <span class="nav-text">Representation</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#State-Transfer"><span class="nav-number">1.3.</span> <span class="nav-text">State Transfer</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#约束条件"><span class="nav-number">2.</span> <span class="nav-text">约束条件</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Uniform-Interface"><span class="nav-number">2.1.</span> <span class="nav-text">Uniform Interface</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Client-Server"><span class="nav-number">2.2.</span> <span class="nav-text">Client-Server</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Stateless"><span class="nav-number">2.3.</span> <span class="nav-text">Stateless</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Cacheable"><span class="nav-number">2.4.</span> <span class="nav-text">Cacheable</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Layered-System"><span class="nav-number">2.5.</span> <span class="nav-text">Layered System</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Code-On-Demand-Optional"><span class="nav-number">2.6.</span> <span class="nav-text">Code On Demand (Optional)</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#最佳实践"><span class="nav-number">3.</span> <span class="nav-text">最佳实践</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Resource-Naming"><span class="nav-number">3.1.</span> <span class="nav-text">Resource Naming</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#使用名词表示资源"><span class="nav-number">3.1.1.</span> <span class="nav-text">使用名词表示资源</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#不要使用-CURD-动词"><span class="nav-number">3.1.2.</span> <span class="nav-text">不要使用 CURD 动词</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#采用查询字符串来过滤"><span class="nav-number">3.1.3.</span> <span class="nav-text">采用查询字符串来过滤</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#URI可读性与持续性"><span class="nav-number">3.1.4.</span> <span class="nav-text">URI可读性与持续性</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Status-Code"><span class="nav-number">3.2.</span> <span class="nav-text">Status Code</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#状态码必须精确"><span class="nav-number">3.2.1.</span> <span class="nav-text">状态码必须精确</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2xx-状态码"><span class="nav-number">3.2.2.</span> <span class="nav-text">2xx 状态码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3xx-状态码"><span class="nav-number">3.2.3.</span> <span class="nav-text">3xx 状态码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4xx-状态码"><span class="nav-number">3.2.4.</span> <span class="nav-text">4xx 状态码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5xx-状态码"><span class="nav-number">3.2.5.</span> <span class="nav-text">5xx 状态码</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Caching"><span class="nav-number">3.3.</span> <span class="nav-text">Caching</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Expires"><span class="nav-number">3.3.1.</span> <span class="nav-text">Expires</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Cache-Control"><span class="nav-number">3.3.2.</span> <span class="nav-text">Cache-Control</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ETag"><span class="nav-number">3.3.3.</span> <span class="nav-text">ETag</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Last-Modified"><span class="nav-number">3.3.4.</span> <span class="nav-text">Last-Modified</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Content-Negotiation"><span class="nav-number">3.4.</span> <span class="nav-text">Content Negotiation</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HATEOAS"><span class="nav-number">3.5.</span> <span class="nav-text">HATEOAS</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Idempotence"><span class="nav-number">3.6.</span> <span class="nav-text">Idempotence</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Versioning"><span class="nav-number">3.7.</span> <span class="nav-text">Versioning</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#URI-Versioning"><span class="nav-number">3.7.1.</span> <span class="nav-text">URI Versioning</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Versioning-using-Accept-header"><span class="nav-number">3.7.2.</span> <span class="nav-text">Versioning using Accept header</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#总结"><span class="nav-number">4.</span> <span class="nav-text">总结</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#参考资料"><span class="nav-number">5.</span> <span class="nav-text">参考资料</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <img class="site-author-image" itemprop="image" alt="Houmin" src="https://cosmos-1251905798.cos.ap-beijing.myqcloud.com/theme/avatar.png">
  <p class="site-author-name" itemprop="name">Houmin</p>
  <div class="site-description" itemprop="description">丈夫拥书万卷，何假南面百城</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">145</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
        <span class="site-state-item-count">8</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">206</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="feed-link motion-element">
    <a href="/atom.xml" rel="alternate">
      <i class="fa fa-rss"></i>RSS
    </a>
  </div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/SimpCosm" title="GitHub &amp;rarr; https:&#x2F;&#x2F;github.com&#x2F;SimpCosm" rel="external nofollow noopener noreferrer" target="_blank"><i class="fa fa-fw fa-github"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:weihoumin@gmail.com" title="E-Mail &amp;rarr; mailto:weihoumin@gmail.com" rel="external nofollow noopener noreferrer" target="_blank"><i class="fa fa-fw fa-envelope"></i></a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        
  <div class="hitokoto">
    <!-- hitokoto -->
    <div id="hito-expression">:D 获取中...</div>

    <script src="https://cdn.jsdelivr.net/npm/bluebird@3/js/browser/bluebird.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/whatwg-fetch@2.0.3/fetch.min.js"></script>
    <script>
      fetch('https://v1.hitokoto.cn')
        .then(function (res){
          return res.json();
        })
        .then(function (data) {
          var hitokoto = document.getElementById('hito-expression');
          hitokoto.innerText = data.hitokoto + '——【' + data.from + '】';
        })
        .catch(function (err) {
          console.error(err);
        })
    </script>
  </div>

<div class="copyright">
  
  &copy; 2019 – 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heartbeat"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Houmin</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
      <span class="post-meta-item-text">站点总字数：</span>
    <span title="站点总字数">1.5m</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span class="post-meta-item-text">站点阅读时长 &asymp;</span>
    <span title="站点阅读时长">45:57</span>
</div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>












        
      </div>
    </footer>
  </div>



  
  <script src="//cdn.jsdelivr.net/npm/animejs@3.1.0/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/lozad@1/dist/lozad.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script>
<script src="/js/schemes/muse.js"></script>
<script src="/js/next-boot.js"></script><script src="/js/bookmark.js"></script>



  




  <script src="/js/local-search.js"></script>








<script>
if (document.querySelectorAll('div.pdf').length) {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/pdfobject@2/pdfobject.min.js', () => {
    document.querySelectorAll('div.pdf').forEach(element => {
      PDFObject.embed(element.getAttribute('target'), element, {
        pdfOpenParams: {
          navpanes: 0,
          toolbar: 0,
          statusbar: 0,
          pagemode: 'thumbs',
          view: 'FitH'
        },
        PDFJS_URL: '/lib/pdf/web/viewer.html',
        height: element.getAttribute('height') || '800px'
      });
    });
  }, window.PDFObject);
}
</script>


<script>
if (document.querySelectorAll('pre.mermaid').length) {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js', () => {
    mermaid.initialize({
      theme: 'forest',
      logLevel: 3,
      flowchart: { curve: 'linear' },
      gantt: { axisFormat: '%m/%d/%Y' },
      sequence: { actorMargin: 50 }
    });
  }, window.mermaid);
}
</script>



  

  

  


<script>
NexT.utils.getScript('//cdn.jsdelivr.net/npm/valine@1/dist/Valine.min.js', () => {
  var GUEST = ['nick', 'mail', 'link'];
  var guest = 'nick,mail,link';
  guest = guest.split(',').filter(item => {
    return GUEST.includes(item);
  });
  new Valine({
    el: '#comments',
    verify: false,
    notify: false,
    appId: 'iEBFuhVyk4tuhVYctQ265uid-gzGzoHsz',
    appKey: 'KGjOktrtgSEWK1v9DYA3T3Az',
    placeholder: "Just go go",
    avatar: 'retro',
    meta: guest,
    pageSize: '10' || 10,
    visitor: false,
    lang: 'zh-cn' || 'zh-cn',
    path: location.pathname,
    recordIP: true,
    serverURLs: ''
  });
}, window.Valine);
</script>

</body>
</html>
